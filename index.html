<!doctype HTML>

<html>
<header>
	<title>CG-MD開発2022年度</title>
	<meta charset="utf-8">
        <script type="text/x-mathjax-config">
                MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}});
        </script>
        <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML,/www_func/MathJax/MyConfig.js">
        </script>

</header>
<body>
<center>
	<h1> CG-MD Modelling</h1>
	-単結晶のswelling curveに基づく水和エネルギーのモデル化-
</center>
<h2>Journal</h2>
<ul>
<li> 01/12(Thr)<br>
当面の目標として，数値解析に用いることのできる水和エネルギーモデルの定式化を行う．
そのために，CG system(粗視化粒子系)の自由エネルギーを次のように定義しなおす．
\begin{equation}
	G=U_{LJ}+U_{hyd}
	\label{eqn:Gtot}
\end{equation}
ここに\(G_{LJ}\)は粒子間相互作用エネルギーを\(U_{hyd}\)は水和エネルギーを表す．
CG系の化学ポテンシャル\(\mu\)は式(\ref{eqn:Gtot})の水分子数\(N\)に関する微分として
次のように表される．
\begin{equation}
	\mu=
	\frac{\partial G}{\partial N}
	=
	\frac{\partial U_{LJ}}{\partial N}
	+
	\frac{\partial U_{hyd}}{\partial N}
	\label{eqn:mu_sys}
\end{equation}
CG系が平衡状態にあるとき，\(\mu\)は外界の化学ポテンシャル\(\mu_{ex}\)とつりあう．すなわち
\begin{equation}
	\mu = \mu_{ex}
	\label{eqn:equiv_mu}
\end{equation}
が成り立つ．いま，粘土含水系が湿度の規定された環境中に置かれていたとする．
その場合\(\mu_{ex}\)は，気体状態での水の化学ポテンシャルとして与えられる．
このことが明確になるように\(\mu_{ex}=\mu_w\)と書くことにする．
\(\mu_w\)は，相対湿度\(r_H\)と次の関係がある．
\begin{equation}
	r_H 
	=
	\frac{\phi(P^{sat}_w)}{\phi(P_w)}	
	\exp\left( -\frac{\mu^{sat}_w-\mu_w }{RT} \right)
	\label{eqn:rH}
\end{equation}
ただし，\(R\)は気体定数，\(T\)は温度，\(\mu_w\)$と\(P_w\)は，それぞれ
粒子浴(ここでは外界の水分溜)の化学ポテンシャルと蒸気圧を表し，
satは飽和状態での量であることを意味する．また，\(\phi\)はフガシティー
係数(fugacity coefficient)を表し，\(r_H\)は0から1の値をとり，パーセント表示する場合には
\(100 r_H\)とする．
相対湿度\(r_H\)と積層した粘土分子の層間距離(basal spacing)\(d\)の関係は
粉末X線回折(XRD:X-ray diffraction)試験によって調べられており，
Na型モンモリロナイトでは，相対湿度の増加にともない
無水状態の0層膨潤から3層膨潤状態まで，階段状に変化することが知られている．
従って，層間距離$h$を相対湿度\(r_H\)の関数として
\begin{equation}
	h=h(r_H; T,P)
	\label{eqn:h_rH}
\end{equation}
と表すことにする．ここで，式(\ref{eqn:h_rH})の右辺は，
層間距離\(h\)$がパラメータ\(T\)と\(P\)を含む\(r_H\)の関数であること
を示している．ただし，これら\(T\)や\(P\)の変化が無視できるときには省略し，
単に\(h=h(r_H)\)と書く．
XRD試験で測定した式(\ref{eqn:h_rH})の関係は，膨潤曲線(swelling curve)と呼ばれる．
例えば，天然のモンモリロナイトについては\(**\)に，合成されたスメクタイト
結晶については\(**\)に測定結果が報告されている．
これらの文献では，モンモリロナイトの膨潤曲線は階段状に変化し，
特に，合成された巨大モンモリロナイト分子の粉末X線回折試験の結果からは，
ほぼ完全な階段状の膨潤曲線が得られることが示されている．
このような実験事実を踏まえれば，膨潤曲線(\ref{eqn:h_rH})は，単位ステップ関数:
\begin{equation}
	H(x)=\left\{
	\begin{array}{lc}
		0,  & (x \lt 0) \\
		1,  & (x \gt 0) \\
	\end{array}
	\right.
	\label{eqn:Hx}
\end{equation}
を用いて次のように表すことができる.
\begin{equation}
	h(r_H)= \sum_{i=0}^3 \Delta h_i H(r_H-r_i)
\end{equation}
ここで,
\begin{equation}
	\mu_w
	=
	\mu_w^{sat} +RT \log 
	\left\{
		\frac{\phi(P_w)}{\phi(P^{sat}_w)}	
		r_H
	\right\}
	\label{eqn:mu_rH}
\end{equation}
より,平衡状態では
\begin{equation}
	\frac{\partial U_{LJ}}{\partial N}
	+
	\frac{\partial U_{hyd}}{\partial N}
	=
	\mu_w^{sat} +RT \log 
	\left\{
		\frac{\phi(P_w)}{\phi(P^{sat}_w)}	
		r_H
	\right\}
	\label{eqn:equiv_rH}
\end{equation}
粘土単結晶の場合，\(N\)と\(r_H\)は，ともに層間距離\(h\)の関数として表すことができるので，
式(\ref{eqn:equiv_rH})を次のように書き直すことができる．
\begin{equation}
	\left( \frac{\partial U_{LJ}}{\partial h}
	+
	\frac{\partial U_{hyd}}{\partial h}
	\right)
	\frac{\partial d}{\partial N}
	=
	\mu_w^{sat} +RT \log 
	\left\{
		\frac{\phi(P_w)}{\phi(P^{sat}_w)}	
		r_H(h)
	\right\}
	\label{eqn:}
\end{equation}
これを水和エネルギー\(U_{hyd}\)の項について解けば，
\begin{equation}
	\frac{\partial U_{hyd}}{\partial h}
	=
	-\frac{\partial U_{LJ}}{\partial h}
	+
	\left[
	\mu_w^{sat} +RT \log 
	\left\{
		\frac{\phi(P_w)}{\phi(P^{sat}_w)}	
		r_H(h)
	\right\}
	\right]
	\frac{\partial N}{\partial h}
\end{equation}
とできるので，この結果を層間距離について積分することで
単結晶に対する水和エネルギー関数が得られる．
ただし，CG-MD解析では水和エネルギーの勾配だけが必要とされる
ため，必ずしも水和エネルギー関数そのものを求める必要はない．
以下，\(U_{LJ}\)や\(r_H(h)\)を具体的に表し，
水和エネルギー勾配が\(h\)に関するどのような関数であるかを調べる．
</li>
<li>01/13(Fri.)<br>
CG系の粒子間相互作用エネルギーは，次のようなLenard-Jones(LJ)ポテンシャルで与えられている．
\begin{equation}
	U(\boldsymbol{x}_i,\boldsymbol{x}_j;\sigma)=4\varepsilon \left\{
	\left( \frac{\sigma}{r_{ij}}\right)^{12}
	-
	\left( \frac{\sigma}{r_{ij}}\right)^{6}
	\right\}
	, \ \ 
	(r_{ij}=|\boldsymbol{x}_i-\boldsymbol{x}_j|)
	\label{eqn:LJ}
\end{equation}
ここに，\(\boldsymbol{x}_i\)は第\(i\)粗視化粒子の位置ベクトルを，
\(\sigma\)はLJポテンシャルの特性距離を表し，ポテンシャルの深さを
決めるパラメータ\(\varepsilon\)の値は
\begin{equation}
\varepsilon=1.0\times 10^{-19}, \ \ ({\rm Nm})
\label{eqn:eps_num}
\end{equation}
である．
</li>
<li>01/14(Sat.)<br>
	膨潤曲線のデータ起こし
	<ol>
	<li>論文Figureのpng画像をsvgzファイルにインポート 
	( <a href="Yamada.svgz">Yamada.svgz</a>, 
	<a href="Morodome.svgz">Morodome.svgz</a> )
	<figure>
		<center>
		<img src="Yamada.png" width=450, height=300></img>
		<img src="Morodome.png" width=450, height=300></img>
		</center>
		<figcaption>論文で報告されNa型スメクタイトの膨潤曲線</figcaption>
	</figure>
	</li>
	<li>
	トレースするグラフにドットを配置 (<a href="measure.svgz">measure.svgz</a>) 
	</li>
	<li>
	配置したドットのobject IDを編集(わかり易い名前に手動で変更)
	</li>
	<li>
	inkscapeコマンドでobject情報[ID,x,y,width,height]を取得(inkscape --query-all measure.svgz)
	</li>
	<li>
	pythonスクリプトでスケールを復元してグラフ化<a href="mkgrph.py">mkgrph.py</a>
	<figure>
		<center>
		<img src="swelling.png" width=400 height=300></img>
		<figcaption>論文から復元した膨潤曲線(Naモンモリロナイト,50℃)(Morodome & Kawamura 2009)</figcaption>
		</center>
	</figure>
	</li>
	</ol>
<li>01/15(Sun.)<br>
	pythonスクリプト<a href="mkgrph.py">mkgrph.py</a>
	で，ステップ関数と誤差関数それぞれを用いて膨潤曲線を近似．<br>
	<figure>
	<center>
		<img src="fitted.png", width=450,height=400></img>
		<figcaption>ステップ関数と誤差関数による膨潤曲線のフィッテイング</figcaption>
	</center>
	</figure>
	misfit分を平滑化すれば、使いやすい関数がられることを期待していたが，再構成した実験データを
	そのまま使う方がよいという結論になった．<br>
	なお，再構成した実験データの点数は、元の実験データ点数より少ない
	(プロットが重なって見えないため). <br> 
	平滑化した膨潤曲線を用いることの問題点: 勾配が負になる箇所が生じ．その箇所で逆関数が1価関数にならない!<br>

	<figure>
	<center>
		<img src="log_rH.png", width=400,height=400></img>
		<figcaption>膨潤曲線から計算したの\( \log \left\{ \gamma_H(h)\right\} \)グラフ</figcaption>
	</center>
	</figure>
	再構成した膨潤曲線のデータはこちら(<a href="rH_x.dat">rH_x.dat</a>)<br>
	この数値データを使って水和エネルギー関数を定義．<br>
	次にやるべきことは，MD膨潤曲線
	\begin{equation}
		h=h(N), \ \ h'(N)=\frac{dh}{dN} 
		\label{eqn:MD_sw}
	\end{equation}
	を数値的にモデル化して使用可能な状態にすること．
<li>01/16(Mon.)<br>
	MD計算結果(MD_Data/
	<a href="MD_Data/NaMt.dat">NaMt.dat</a>, 
	<a href="MD_Data/CaMt.dat">CaMt.dat</a>)
	<br>
	いずれも水分子数0のときのデータを1行目に加筆.<br>
	<br>
	dn/dhの計算とグラフ表示には
	<a href="MD_Data/mk_dndh.py">mk_dndh.py</a> --> mk_dndh.png(画像), mk_dndh.dat(データ)
	を使用.<br>
	<figure>
	<center>
		<img src="MD_Data/mk_dndh.png", width=500, height=400></img>
		<figcaption>全原子MD解析で得られた水分子数\(n\)と層間距離\(h\)の関係(上)と，
			層間距離に対する水分子数の増加率(下).
		</figcaption>
	</center>
	</figure>
	<br>
	データ補間と水和エネルギーモデルの作成(<a href="uhyd.py">uhyd.py</a>)<br>
	数値データは<a href="uhyd.dat">uhyd.dat</a>に保存される．
	<br>
	<figure>
	<center>
		<img src="uhyd.png", width=400, height=300></img>
		<figcaption>
		XRDデータ(rH_x.dat)とMDデータ(mk_dndh.dat)を元にしてモデル化した水和エネルギー関数.
		</figcaption>
	</center>
	</figure>

</li>
<li>01/19(Thr.)<br>
	MD計算と実験で得られた膨潤曲線を，CG-MD計算に利用するための準備<br>

	<a href="MD_Data/NaMt.dat">MD_Data/NaMt.dat</a>から
	n(H2O)--h間のマッピング作成プログラム=
	<a href="MD_Data/NHmap.cpp">(MD_Data/NHmap.cpp)</a> <br>
	出力ファイル:<br>
	n->h mapping(元データそのまま):
	<a href="MD_Data/n2h.dat">MD_Data/n2h.dat</a> <br>
	h->2 mapping(等間隔グリッドへ補間):
	<a href="MD_Data/h2n.dat">MD_Data/h2n.dat</a> <br>
	を生成．

	<br>
	<br>
	XRD膨潤曲線データ(<a href="rH_x.dat">rH_x.dat</a>)の書式変更(先頭行にデータ数を追加)<br>
	連動して<a href="uhyd.py">uhyd.py</a>のデータ読み込みmethodを修正

</li>
</ul>
<br>
CG-MDのLJポテンシャル、d-N変換式の定式化
<br>
<h2>References</h2>
<ul>
	<li>H. Yamada, H. Nakazawa, H. Hashizume, S. Shimomura, and T. Watanabe,
	"Hydration behavior of Na-smectite crystals synthesized at high pressure and high temperature,
	Clays and Clay Minerals, vol.42, No.1, pp.77-80, 1994.
	</li>
	<li>
	S. Morodome and K. Kawamura,
	"Swelling behavior of Na- and Ca-montmorillonite up to 150°C by in situ X-Ray diffraction experiments",
	, Clays and Clay Minerals,vol.57, pp.150-160, 2009.
	</li>
	<li>
		T. J. Tambach, P. G. Bolhuis, E. J.M. Hensen, and B. Smit, 
		"Hysterisis in clay swelling induced by hydrogen bonding: Accurate prediction of swelling state, 
		Langmuire, vol.22, pp.1223-1234, 2006.
	</li>
</ul>
</body>
</html>
